{% extends "layout.html" %}
{% block header %}

    <link rel="stylesheet" href="{{ url_for('static', filename='css/job_list.css') }}">
    <script id="new_job_table_tmpl" type="x-tmpl">
        <table>
            <tr>
                <% for (var j = 0; j < rows[0].length; j++) { %>
                <th><%= rows[0][j]; %></th>
                <% } %>
            </tr>
            <% for (var i = 1; i < rows.length && i < 4; i++) { %>
            <tr>
                <% for (var j = 0; j < rows[i].length; j++) { %>
                <td><%= rows[i][j]; %></td>
                <% } %>
            </tr>
            <% } %>
            <tr>
                <td colspan="4" align="center">REQUIRED</td>
                <td colspan="<%= (rows[0].length - 5); %>" align="center">COV</td>
                <td colspan="1" align="center">PHENO</td>
            </tr>
        </table>
    </script>

    <script id="table_row_tmpl" type="x-tmpl">
        <tr>
            <th>Job Name</th>
            <th>Date Created</th>
            <th>Status</th>
        </tr>
        <% jobs.forEach(function(j) { %>
        <tr data-id="<%= j.id; %>">
            <td><%= j.name; %></td>
            <td><%= j.creation_date; %></td>
            <td><%= j.status; %></td>
        </tr>
        <% }); %>
        <% if (jobs.length === 0) { %>
        <tr>
            <td colspan="4" align="center">No jobs were found.</td>
        </tr>
        <% } %>
    </script>

    <script id="empty_table_row_tmpl" type="x-tmpl">
        <tr>
            <td colspan="3" align="center"></td>
        </tr>
    </script>

    <script type="text/javascript" src="{{ url_for('static', filename='js/ejs.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='js/job_list.js') }}"></script>

	<script type="text/javascript">
		$(document).ready(function() {
			init_upload_box();
			init_job_list();
			init_vcf_stats();
		});
	</script>

{% endblock %}
{% block content %}
        <div class="section">
            <div id="carousel" style="text-align: center">
                <table>
                    <tr class="genotype-stats">
                        <td>
                            0
                        </td>
                        <td>
                            &nbsp;Genotypes
                        </td>
                    </tr>
                    <tr class="marker-stats">
                        <td>
                            0
                        </td>
                        <td>
                            &nbsp;Markers
                        </td>
                    </tr>
                    <tr class="sample-stats">
                        <td>
                            0
                        </td>
                        <td>
                            &nbsp;Individuals
                        </td>
                    </tr>
                </table>
                <b style="color: rgb(1, 45, 107);">Ready For Analysis!</b>
            </div>
        </div>

        <div class="section">
            <style type="text/css">
                /*.ubox-dragndrop,
                .ubox-uploading,
                .ubox-success,
                .ubox-error
                {
                    display: none;
                }*/

                .ubox
                {
                    position: relative;
                    height: 220px;
                    outline: 2px dashed #666666;
                    outline-offset: -10px;
                }

                .ubox-progress
                {
                    position: absolute;
                    left: 0;
                    top: 0;
                    width: 0%;
                    height: 100%;
                    z-index: -1;
                    background: rgba(0, 50, 255, 0.2);
                    border-radius: 4px;
                }

                .ubox.is-dragged-over
                {
                    background: rgba(0, 50, 255, 0.2);
                }

                .ubox .ubox-dragndrop
                {
                    display: inline;
                }

                .ubox label
                {
                    cursor: pointer;
                }

                button[name=upload]
                {
                    font-size: 14px;
                }

                .ubox-input-view,.ubox-submit-view
                {
                    width: 100%;
                    height: 100%;
                    position: relative;
                }
            </style>
            <form class="ubox vflex" method="post" action="" enctype="multipart/form-data">
                <div class="ubox-progress">&nbsp;</div>
                <br/>
                <svg class="ubox-icon" xmlns="http://www.w3.org/2000/svg" width="50" height="43" viewBox="0 0 50 43"><path d="M48.4 26.5c-.9 0-1.7.7-1.7 1.7v11.6h-43.3v-11.6c0-.9-.7-1.7-1.7-1.7s-1.7.7-1.7 1.7v13.2c0 .9.7 1.7 1.7 1.7h46.7c.9 0 1.7-.7 1.7-1.7v-13.2c0-1-.7-1.7-1.7-1.7zm-24.5 6.1c.3.3.8.5 1.2.5.4 0 .9-.2 1.2-.5l10-11.6c.7-.7.7-1.7 0-2.4s-1.7-.7-2.4 0l-7.1 8.3v-25.3c0-.9-.7-1.7-1.7-1.7s-1.7.7-1.7 1.7v25.3l-7.1-8.3c-.7-.7-1.7-.7-2.4 0s-.7 1.7 0 2.4l10 11.6z"></path></svg>
                <input style="display: none" type="file" name="ped_file" id="ubox_file_input" accept=".ped"  />
                <label for="ubox_file_input"><strong>Choose PED file</strong><span class="ubox-dragndrop"> or drag it here</span>.</label>
                <button class="ubox-button" type="button" name="upload" style="display: none;">Create New Job</button>
                <br/>
                <!--<div class="ubox-uploading">Uploading&hellip;</div>
                <div class="ubox-success">Done!</div>
                <div class="ubox-error">Error! <span></span>.</div>-->

            </form>
        </div>

        <div id="new_job_table_scroll_box" class="scroll-box">
        </div>

        <br/>

        <div class="section">
            <div class="section-title">
                <h2>Jobs</h2>
                <!--<button id="create_job_button">+</button>-->
            </div>
            <table id="jobs_table">
                <tr>
                    <th>Job Name</th>
                    <th>Date Created</th>
                    <th>Status</th>
                </tr>
                <!--<tr>
                    <td>--</td>
                    <td>--</td>
                    <td>--</td>
                </tr>
                <tr>
                    <td>--</td>
                    <td>--</td>
                    <td>--</td>
                </tr>-->
                <tr>
                    <td colspan="3" align="center">Loading ...</td>
                </tr>
            </table>
        </div>
{% endblock %}
